# Проблема многорукого бандита

## Что такое рука?

Во-первых, мы хотим учесть возможность того, что у нас есть не два, а сотни или тысячи цветов на выбор. 

В общем, мы будем считать, что у нас есть фиксированный набор из N различных вариантов и что мы можем их перечислить, так что мы можем назвать наш зеленый логотип Вариантом 1, наш красный логотип Вариантом 2 и любой другой логотип Вариантом N. 

По историческим причинам эти варианты обычно называют руками, поэтому мы будем говорить о Руке 1, Руке 2 и Руке N, а не о Варианте 1, Варианте 2 или Варианте N. 

Но основная идея остается неизменной независимо от того, какие слова мы выберем.

Это название имеет смысл, если учесть изначальные мотивы разработки алгоритмов: эти алгоритмы были изначально придуманы для того, чтобы объяснить, как идеализированный азартный игрок попытается заработать как можно больше денег в гипотетическом казино. 

В этом гипотетическом казино есть только один тип игры: игровой автомат, который также иногда называют "одноруким бандитом" из-за его способности забирать ваши деньги. В этом казино есть множество различных игровых автоматов, каждый из которых имеет свой шанс выдать выигрыш.

Например, некоторые игровые автоматы в этом гипотетическом казино могут выплачивать 5 долларов при 1 из 100 выпадений, а другие - 25 долларов при 1 из 1000 выпадений и так далее. 

По какой-то причине первоначальные математики решили рассматривать различные игровые автоматы в своем мысленном эксперименте так, как если бы они были одним гигантским игровым автоматом, у которого было много рук. 

Это привело к тому, что они стали называть варианты в своей задаче руками. Это также привело к тому, что они назвали этот мысленный эксперимент "проблемой многорукого бандита". 

Мы и по сей день называем эти алгоритмы алгоритмами бандитов, поэтому знание исторических названий помогает объяснить, почему мы называем различные варианты руками.

## Что такое награда? 

Награда - это просто мера успеха: она может говорить нам о том, кликнул ли клиент на рекламу или зарегистрировался как пользователь. Важно лишь то, что 
- (A) вознаграждение - это нечто количественное, что мы можем отслеживать математически, 
- и что (B) большие суммы вознаграждения лучше, чем меньшие.

## Что такое проблема бандита?

- **1.** Перед нами сложный игровой автомат, называемый бандитом, у которого есть набор из N рук, за которые мы можем потянуть.
- **2.** Если потянуть за любой рычаг, он выдаст вознаграждение. Но эти награды не надежны, поэтому мы играем в азартные игры: рука 1 может дать нам 1 единицу награды только в 1% случаев, а рука 2 - только в 3% случаев. Любое конкретное дергание любой конкретной руки рискованно.
- **3.** Мало того, что каждое дергание руки сопряжено с риском, мы еще и не знаем, каков размер вознаграждения для каждой из рук. Мы должны выяснить это экспериментально, потянув за неизвестные руки.

До сих пор описанная нами проблема была просто задачей из области статистики: вам нужно справиться с риском, выяснив, какая рука имеет наибольшее среднее вознаграждение. Вы можете вычислить среднее вознаграждение, потянув за каждую руку много раз и вычислив среднее значение полученных вами вознаграждений. Но настоящая проблема бандита сложнее.

Особенность проблемы бандита заключается в том, что мы получаем лишь малую часть информации о вознаграждении, полученном от каждой руки. В частности: 

- **4.** Мы узнаем только о вознаграждении, которое было выдано той рукой, которую мы вытянули. Какую бы руку мы ни тянули, мы упускаем информацию о других руках, которые мы не тянули. Как и в реальной жизни, вы узнаете только о том пути, который выбрали, но не о тех, которые могли бы выбрать.

**Замечание.** Такая проблема встречается и в других областях. Например, представьте, что мы хотим понять, как повлияет звонок на решение клиента о приобретении товара. Тогда нам нужно "создать два параллельных мира". В одном предложить товар клиентам, а в другом не предложить. И, таким образом, оценить две вероятности: вероятность склонности клиента к приобретению товара при звонке и без звонка. Но проблема в том, что в реальном мире мы не можем и позвонить и не позвонить клиенту одновременно. (Такие задачи решаются с помощью uplift моделей). Тоже самое и с бандитами: мы не можем одновременно дернуть все ручки, можем дернуть только одну.  

На самом деле ситуация еще хуже. Мы не только получаем лишь частичную обратную связь о прошлых решениях, мы буквально отстаем каждый раз, когда не принимаем правильного решения: 

- **5.** Каждый раз, когда мы экспериментируем с рукой, которая не является лучшей, мы теряем вознаграждение, потому что мы могли бы потянуть за лучшую руку.

**Полная проблема многорукого бандита** определяется пятью вышеперечисленными характеристиками.